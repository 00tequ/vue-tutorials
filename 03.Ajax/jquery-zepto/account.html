<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" href="style.css" />
	</head>

	<body>
		<div class="container">

			<div class="left">
				<div class="form-group">
					<label>Email</label>
					<input type="text" id="regEmail" />
				</div>
				<div class="form-group">
					<label>Password</label>
					<input type="text" id="regPassword" />
				</div>

				<div class="form-group">
					<label>Confirm Password</label>
					<input type="text" id="regConfirmPassword" />
				</div>

				<div class="form-group">
					<label></label>
					<button id="register">Register</button>
				</div>
			</div>
			<div class="right">
				<div class="form-group">
					<label>Email</label>
					<input type="text" id="logEmail" />
				</div>
				<div class="form-group">
					<label>Password</label>
					<input type="text" id="logPassword" />
				</div>
				<div class="form-group">
					<label></label>
					<button id="login">Login</button>
				</div>
				<div>
					Access Token: <span id="accessToken"></span>
				</div>
			</div>
		</div>

	</body>
	<script src="js/vue.js"></script>
	<script src="js/zepto.js"></script>
	<script src="js/ajax-helper.js"></script>

	<script>
		$(function() {

			var ajaxHelper = new AjaxHelper()
			var feature = {
				configs: {
					registerUrl: 'http://localhost:64474/api/Account/Register',
					loginUrl: 'http://localhost:64474/token'
				},
				registerDone: function(data) {
					alert('register successfully!')
				},
				getRegisterData: function() {
					return {
						email: $('#regEmail').val(),
						password: $('#regPassword').val(),
						confirmPassword: $('#regConfirmPassword').val()
					}
				},
				register: function() {
					$('#register').click(function() {
						ajaxHelper.post(feature.configs.registerUrl, feature.getRegisterData(), feature.registerDone)
					})
				},
				getLoginData() {
					return {
						grant_type: 'password',
						username: $('#logEmail').val(),
						password: $('#logPassword').val(),
					}
				},
				loginDone: function(data) {
					$('#accessToken').text(data.access_token)
				},
				login: function() {
					$('#login').click(function() {
						ajaxHelper.post(feature.configs.loginUrl, feature.getLoginData(), feature.loginDone)
					})
				},
				setup: function() {
					feature.register()
					feature.login()
				}
			}
			feature.setup()
		})
	</script>

</html>
